<div class="p-6 bg-zinc-50 min-h-full">

  <!-- Page Header -->
  <div class="mb-6">
    <h1 class="text-2xl font-semibold text-zinc-900 tracking-tight">Order Management</h1>
    <p class="text-sm text-zinc-500 mt-1">View, filter, and manage all customer orders</p>
  </div>

  <!-- Table Card -->
  <div class="bg-white border border-zinc-200 rounded-xl shadow-sm overflow-hidden">

    <!-- Card Header with Filter -->
    <div class="flex items-center justify-between p-5 border-b border-zinc-200 bg-white">
      <div>
        @if (loading()) {
          <p-skeleton width="7rem" height="1.125rem" styleClass="mb-1.5"></p-skeleton>
          <p-skeleton width="5rem" height="0.875rem"></p-skeleton>
        } @else {
          <h2 class="text-base font-semibold text-zinc-900">All Orders</h2>
          <p class="text-xs text-zinc-500 mt-0.5">{{ filteredOrders().length }} orders found</p>
        }
      </div>
      <p-select
        [options]="statusOptions"
        [(ngModel)]="selectedStatus"
        optionLabel="label"
        optionValue="value"
        placeholder="Filter by Status"
        [disabled]="loading()"
        (onChange)="onStatusFilterChange($event.value)"
        styleClass="w-48"
      ></p-select>
    </div>

    <!-- ── SKELETON (loading) ── -->
    @if (loading()) {
      <!-- Fake header row -->
      <div class="grid grid-cols-6 gap-4 px-5 py-3 bg-zinc-50 border-b border-zinc-200">
        @for (w of ['5rem','8rem','11rem','5rem','6rem','4rem']; track w) {
          <p-skeleton [width]="w" height="0.75rem"></p-skeleton>
        }
      </div>
      <!-- Fake body rows -->
      @for (row of [1,2,3,4,5,6,7]; track row) {
        <div class="grid grid-cols-6 gap-4 px-5 py-4 border-b border-zinc-100 items-center last:border-b-0">
          <p-skeleton width="5rem" height="0.875rem"></p-skeleton>
          <p-skeleton width="7rem" height="0.875rem"></p-skeleton>
          <p-skeleton width="10rem" height="0.875rem"></p-skeleton>
          <p-skeleton width="4rem" height="0.875rem"></p-skeleton>
          <p-skeleton width="5.5rem" height="1.5rem" borderRadius="2rem"></p-skeleton>
          <p-skeleton shape="circle" size="2rem"></p-skeleton>
        </div>
      }
      <!-- Fake paginator -->
      <div class="flex items-center justify-end gap-3 px-5 py-3 border-t border-zinc-200 bg-zinc-50">
        @for (i of [1,2,3,4,5]; track i) {
          <p-skeleton shape="circle" size="2rem"></p-skeleton>
        }
        <p-skeleton width="5rem" height="2rem" borderRadius="0.375rem"></p-skeleton>
      </div>

    } @else {
      <!-- ── REAL TABLE ── -->
      <p-table
        [value]="filteredOrders()"
        [rows]="10"
        [paginator]="true"
        [rowsPerPageOptions]="[5, 10, 20]"
        [tableStyle]="{ 'min-width': '50rem' }"
        styleClass="p-datatable-sm"
        selectionMode="single"
        (onRowSelect)="viewOrder($any($event.data))"
      >
        <ng-template #header>
          <tr>
            <th scope="col">Order ID</th>
            <th scope="col">Customer</th>
            <th scope="col">Date</th>
            <th scope="col">Amount</th>
            <th scope="col">Status</th>
            <th scope="col">Actions</th>
          </tr>
        </ng-template>
        <ng-template #body let-order>
          <tr class="cursor-pointer hover:bg-zinc-50!">
            <td class="font-medium text-zinc-800">{{ order.id }}</td>
            <td class="text-zinc-600">{{ order.customerName }}</td>
            <td class="text-zinc-500 text-sm">{{ order.orderDate | date:'MMM d, y · h:mm a' }}</td>
            <td class="font-semibold text-zinc-800">₹{{ order.totalAmount | number }}</td>
            <td>
              <p-tag
                [value]="order.status"
                [severity]="getStatusSeverity(order.status)"
                [rounded]="true"
              ></p-tag>
            </td>
            <td>
              <p-button
                icon="pi pi-eye"
                [text]="true"
                [rounded]="true"
                severity="secondary"
                pTooltip="View Details"
                (onClick)="viewOrder(order)"
              ></p-button>
            </td>
          </tr>
        </ng-template>
        <ng-template #emptymessage>
          <tr>
            <td colspan="6" class="text-center text-sm text-zinc-400 py-10">
              <i class="pi pi-inbox text-3xl text-zinc-300 mb-2 block"></i>
              No orders match the selected filter.
            </td>
          </tr>
        </ng-template>
      </p-table>
    }

  </div>

</div>
