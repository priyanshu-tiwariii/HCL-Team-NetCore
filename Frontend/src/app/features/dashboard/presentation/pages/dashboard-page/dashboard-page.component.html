<div class="p-6 bg-zinc-50 min-h-full">
  <!-- Page Header -->
  <div class="mb-6">
    <h1 class="text-2xl font-semibold text-zinc-900 tracking-tight">Dashboard</h1>
    <p class="text-sm text-zinc-500 mt-1">Overview of your food delivery operations</p>
  </div>

  <!-- Metric Cards -->
  @if (metrics()) {
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
      @for (card of metricCards; track card.key; let i = $index) {
        <div
          class="bg-white border border-zinc-200 rounded-xl p-5 shadow-sm flex items-start gap-4 hover:shadow-md transition-shadow"
        >
          <div
            class="h-10 w-10 rounded-lg flex items-center justify-center shrink-0"
            [ngClass]="{
              'bg-zinc-900': i === 0,
              'bg-zinc-700': i === 1,
              'bg-zinc-500': i === 2,
              'bg-zinc-300': i === 3,
            }"
          >
            <i
              [class]="card.icon + ' text-lg'"
              [ngClass]="{
                'text-white': i < 3,
                'text-zinc-700': i === 3,
              }"
            ></i>
          </div>
          <div class="min-w-0 flex-1">
            <p class="text-xs font-medium text-zinc-500 uppercase tracking-wide">
              {{ card.label }}
            </p>
            <p class="text-2xl font-bold text-zinc-900 mt-1 tracking-tight">
              {{ card.prefix }}{{ getMetricValue(card.key) | number }}
            </p>
          </div>
        </div>
      }
    </div>
  }

  <!-- Charts Row -->
  <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mt-6">
    <!-- Revenue Chart (spans 2 cols) -->
    <div class="lg:col-span-2 bg-white border border-zinc-200 rounded-xl shadow-sm p-6">
      <div class="flex items-center justify-between mb-6">
        <div>
          <h2 class="text-base font-semibold text-zinc-900">Revenue Overview</h2>
          <p class="text-xs text-zinc-500 mt-0.5">Last 7 days</p>
        </div>
      </div>
      @if (revenueChartData()) {
        <div class="h-70">
          <p-chart
            type="line"
            [data]="revenueChartData()"
            [options]="revenueChartOptions()"
            height="280px"
          ></p-chart>
        </div>
      }
    </div>

    <!-- Category Doughnut Chart -->
    <div class="bg-white border border-zinc-200 rounded-xl shadow-sm p-6">
      <div class="mb-6">
        <h2 class="text-base font-semibold text-zinc-900">Popular Categories</h2>
        <p class="text-xs text-zinc-500 mt-0.5">Order distribution</p>
      </div>
      @if (categoryChartData()) {
        <div class="h-70 flex items-center justify-center">
          <p-chart
            type="doughnut"
            [data]="categoryChartData()"
            [options]="categoryChartOptions()"
            height="280px"
          ></p-chart>
        </div>
      }
    </div>
  </div>

  <!-- Recent Orders Table -->
  <div class="bg-white border border-zinc-200 rounded-xl shadow-sm mt-6">
    <div class="p-6 pb-2">
      <h2 class="text-base font-semibold text-zinc-900">Recent Orders</h2>
      <p class="text-xs text-zinc-500 mt-0.5">Latest customer orders and their status</p>
    </div>

    <p-table
      [value]="recentOrders()"
      [rows]="10"
      [tableStyle]="{ 'min-width': '60rem' }"
      styleClass="p-datatable-sm"
    >
      <ng-template #header>
        <tr>
          <th scope="col">Order ID</th>
          <th scope="col">Customer</th>
          <th scope="col">Items</th>
          <th scope="col">Amount</th>
          <th scope="col">Status</th>
          <th scope="col">Actions</th>
        </tr>
      </ng-template>
      <ng-template #body let-order>
        <tr class="hover:bg-zinc-50! border-b! border-zinc-100! transition-colors">
          <td class="text-sm! font-medium! text-zinc-800!">
            {{ order.id }}
          </td>
          <td class="text-sm! text-zinc-600!">
            {{ order.customerName }}
          </td>
          <td class="text-sm! text-zinc-500!">
            {{ order.items }}
          </td>
          <td class="text-sm! font-semibold! text-zinc-800!">
            â‚¹{{ order.totalAmount | number }}
          </td>
          <td>
            <p-tag
              [value]="order.status"
              [severity]="getStatusSeverity(order.status)"
              [rounded]="true"
            ></p-tag>
          </td>
          <td>
            @if (getNextStatus(order.status)) {
              <p-button
                [label]="'Mark ' + getNextStatus(order.status)"
                size="small"
                [text]="true"
                severity="secondary"
                (onClick)="updateOrderStatus(order.id, getNextStatus(order.status)!)"
                styleClass="text-xs! font-medium! text-zinc-500!"
              ></p-button>
            } @else {
              <span class="text-xs text-zinc-400 italic">Completed</span>
            }
          </td>
        </tr>
      </ng-template>
      <ng-template #emptymessage>
        <tr>
          <td colspan="6" class="text-center! text-sm! text-zinc-400! py-8!">No orders found.</td>
        </tr>
      </ng-template>
    </p-table>
  </div>
</div>
